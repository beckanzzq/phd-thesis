\chapter{Classical dipolar XY model}
\label{xy_model}

The classical XY model with ferromagnetic long-range dipolar couplings is given by
\begin{align}
    H = -J a^3 \sum_{i\ne j} \frac{\vec{S}_i \cdot \vec{S}_j}{|\vecR_i - \vecR_j|^3}
  = -J \sum_{i\ne j} \frac{\cos(\theta_i - \theta_j)}{|\vecr_{ij}|^3}.
\end{align}
Here, $J>0$ is the coupling constant, $\vec{S}_i=(\cos \theta_i, \sin \theta_i)^t$ are classical spins restricted to two dimensions and $\vecr_{ij}=(\vecR_i - \vecR_j)/a$ is the dimensionless relative distance, used for conciseness.

\section{High temperature expansion}
With the reduced inverse temperature $\beta = J/kT$, we can write the partition function as
\begin{align}
    Z=\int\prod_{k} \frac{\mathrm{d}\theta_k}{2\pi}  \operatorname{exp}\!\bigg(\beta \sum_{i\ne j} \cos(\theta_i - \theta_j) |\vecr_{ij}|^{-3} \bigg).
\end{align}
% \begin{align}
%     Z=\int\prod_{k} \frac{\mathrm{d}\theta_k}{2\pi}  \prod_{i\ne j}  \bb{1 + \beta \cos(\theta_i - \theta_j) |\vecr_{ij}|^{-3}} + \mathcal{O}(\beta^2)
% \end{align}
In the high temperature limit $\beta \ll 1$, keeping only linear terms in $\beta$,
the two-point correlation function $\meanv{\vec{S}_\alpha \vec{S}_\beta}$ is given by
\begin{align}
    \meanv{\vec{S}_\alpha \vec{S}_\beta} &= \meanv{\cos(\theta_\alpha - \theta_\beta)} \\ &= \frac{1}{Z} \int\prod_{k} \frac{\mathrm{d}\theta_k}{2\pi}  \cos(\theta_\alpha - \theta_\beta)
    \prod_{i\ne j}  \bb{1 + \beta \cos(\theta_i - \theta_j) |\vecr_{ij}|^{-3}}
\end{align}
After integration over all angles, only two terms in the expansion of the product contribute to the lowest order: $\beta \cos(\theta_\alpha - \theta_\beta) |\vecr_{\alpha\beta}|^{-3}$ and $\beta \cos(\theta_\beta - \theta_\alpha) |\vecr_{\beta\alpha}|^{-3}$. Then, the correlation function is given by
\begin{align}
% \meanv{\vec{S}_\alpha \vec{S}_\beta} &= \frac{1}{Z} \int\prod_{k} \frac{\mathrm{d}\theta_k}{2\pi} 2 \beta \cdot \frac{\cos(\theta_\alpha}-\vec{\beta}}^3} \\
% &= \frac{\beta}{Z} \frac{1}{\absv{\vec{\alpha}-\vec{\beta}}^3} + O\bb{\beta^2}
    \meanv{\vec{S}_\alpha \vec{S}_\beta} &= \frac{2 \beta}{Z} \int\prod_{k} \frac{\mathrm{d}\theta_k}{2\pi} \cos(\theta_\alpha - \theta_\beta)^2 \absv{\vecr_{\alpha\beta}}^{-3}
    = \frac{\beta}{Z} \frac{1}{\absv{\vecr_{\alpha\beta}}^3} = \frac{\beta}{|\vecr_{\alpha\beta}|^3}.
\end{align}
In the last step, we have used that $Z = 1+ \mathcal{O}(\beta^3)$, as the smallest loop includes three terms.
