\chapter{Topological band structures}
\label{topological_bands}

A well established concept for the generation of two-dimensional topologically ordered states exhibiting anyonic excitations are flat bands characterized by a topological invariant in combination with strong interactions~\cite{Bergholtz2013,Parameswaran2013}.
The prime example is the fractional quantum Hall effect, where strong magnetic fields generate Landau levels~\cite{Nayak2008}.
Furthermore, lattice models without Landau levels have been proposed for the realization of topological bands~\cite{Haldane1988,Raghu2008,Wang2011,Neupert2011,Wang2012a,Grushin2012,Moller2009,Sun2010,Barkeshli2012,Wang2011a,Sterdyniak2013,Liu2012,Yao2013,Yang2012,Dauphin2012,Cooper2012,Cooper2013,Shi2013}.
Notably, spin-orbit coupling has emerged as an experimentally promising tool for band structures with topological invariants~\cite{Kane2005,Pesin2009,Qi2011,Hasan2010,Tang2011,Qiao2011}.
In this chapter, we show that dipolar interactions, exhibiting intrinsic spin-orbit coupling, can be exploited for the realization of topological bands with cold polar molecules.

In cold gases experiments, the phenomenon that dipolar interactions exhibit spin-orbit coupling is at the heart of demagnetization cooling~\cite{Hensler2003,Fattori2006,Pasquiou2011,DePaz2013a},
and has been identified as the driving mechanism for the Einstein-de Haas effect in Bose-Einstein condensates~\cite{Kawaguchi2006} and the pattern formation in spinor condensates~\cite{Santos2006,Vengalattore2008,Kurn2013}.
Dipolar relaxation can also be used as a mechanism to reach the quantum Hall regime by the controlled insertion of orbital angular momentum, see \cref{dipolar_fermions}.
Recently, it has been pointed out that dipolar spin-orbit coupling can be observed in band structures realized with polar molecules~\cite{Syzranov2014}.
These ideas are motivated by the experimental success in cooling and trapping polar molecules in optical lattices~\cite{Ni2008b,Yan2013}.

Here, we show that a system of polar molecules gives rise to topological band structures, exploiting the spin-orbit coupling of dipolar interactions in combination with a term that breaks time-reversal symmetry.
The main advantages of our realization are its robustness and the low experimental requirements, while many alternative theoretical proposals with cold gases require strong spatially inhomogeneous laser fields with variations on the scale of one lattice constant~\cite{Liu2010,Stanescu2010,Goldman2013,Li2008,Yao2012,Yao2013,Goldman2013,Jaksch2003}.
We point out that our proposal can also be applied to Rydberg atoms in similar setups~\cite{Barredo2014,Piotrowicz2013,Nogrette2014}.

\section{Introduction to topological band structures}

As an introduction to topological band structures, we shortly review the theory for a two-band model.
For a detailed overview of this topic, see~\refscite{Hasan2010,Bernevig2013}.
Consider the following generic tunneling Hamiltonian
\begin{align}
    H = \sum_{i\ne j} \psiopd_i T_{ij} \psiop_j,
\end{align}
where $\psiopd_i = (\bopd_{i,+}, \bopd_{i,-})$ is a spinor-operator acting on lattice site $i$ at position $\vecR_i$, involving two creation operators which are related to an internal degree of freedom or to the specific position in a model with a two-site unit cell like graphene.
The tunneling elements are described by the two-by-two matrix $T_{ij}$.
As will become clear later, we can assume that $T_{ij}$ is traceless, since we are only interested in the topological properties.
Assuming translational symmetry, the model can be block-diagonalized in momentum space by introducing the Fourier representation $\psiop_{\veck}=\frac{1}{\sqrt{N_s}}\sum_{j} \psiop_{j}\ef{i\veck\vec{R}_j}$, with $N_s$ the number of lattice sites:
\begin{align}
    H=\sum_\veck \psiopd_{\veck} H^{\vphantom\dag}_\veck \psiop_{\veck}, \qquad
    H^{\vphantom\dag}_\veck = \sum_{i\ne 0} T_{i0} \ef{-i\veck \vecR_i}.
\end{align}
Since the Bloch-Hamiltonian is a traceless Hermitian two-by-two matrix, it can always be written as the product $H_\veck = \vec{n}_\veck \cdot \vecsigma$ of a three-dimensional real vector $\vec{n}_{\veck}$ and the vector of Pauli matrices $\vecsigma$.
Note that the vector $\vec{n}_\veck \in \mathds{R}^3$ includes the full information about this system.
In particular, the two band dispersion relation is simply given by $E_\veck = \pm |\vec{n}_\veck|$.

\fig{.8}{chern2/wrapping}{Visualization of (an equivalence class of) mappings $T^2\goesto S^2$ from a torus to a sphere with a nontrivial winding number $C=2$. We start by placing the sphere inside the torus, which has been cut along the blue circle. Twisting the upper half of the torus by $2\pi$ and folding down, we can seal the torus along the blue circle and contract the glued joint to a single point. Now, each point on the torus $T^2$ lies on (points to) a specific position on the surface of the sphere. The torus covers the sphere twice, hence the winding number of two.}

An almost trivial observation in topological band theory is the realization that $\vec{n}_\veck$ contains more information than just the dispersion relation.
To see this, we assume that (for a certain set of parameters) the model has no band-crossing, such that the vector $\vec{n}_\veck$ is nonzero for all $\veck$ in the Brillouin zone.
Then, we can \qu{factor out} the information about the dispersion relation and consider the normalized vector $\hat{\vec{n}}_\veck = \vec{n}_\veck/|\vec{n}_\veck|$.
Mathematically, this is a mapping $\hat{\vec{n}}\colon T^2 \goesto S^2$ from a two-torus $T^2$ (the structure of the two-dimensional Brillouin zone) to the two-sphere $S^2$ (because the three-dimensional vector is normalized).
Continuous functions of this kind can be classified with topological methods.
It is possible to visualize a mapping $T^2 \goesto S^2$ (see \tref{chern2/wrapping} for an example), but it is easier to continue this discussion with a conceptually easier mapping $S^2 \to S^2$ from a sphere to itself.
It can be shown that the classification is in fact equivalent~\cite{Moore2011}.
In algebraic topology, continuous functions with the general structure $S^k \goesto S^n$ are classified by the $k$-th homotopy group of the $n$-sphere, denoted by $\pi_k(S^n)$.
Functions $f\colon S^1 \goesto S^1$ from the unit-circle to itself, for example, are classified by the first homotopy group (called the fundamental group).
It is well known that $\pi_1(S^1) \cong \mathds{Z}$ because these mappings can be classified by a winding number
\begin{align}
    \nu = \frac{1}{2\pi}\integralb{0}{2\pi}{k} \partial_k f(k) = \frac{f(2\pi)-f(0)}{2\pi}
\end{align}
that counts how many times the origin is encircled as we integrate over $k \in S^1$.
For our two-dimensional model, we are interested in the second-homotopy group of the two-sphere.
It turns out that $\pi_2(S^2) \cong \mathds{Z}$.
Consequently, different mappings $\hat{\vec{n}}_\veck$ (that is, different band structures) can be classified by a topological index $C \in \mathds{Z}$: the Chern number.
In a similar way to the one-dimensional example, the Chern number can be calculated as a winding number of the vector $\hat{\vec{n}}_\veck$ via:
\begin{align}
    C &= \frac{1}{4\pi}\integralb{\text{BZ}}{}{^2\veck} ( \partial_{k_x} \hat{\vec{n}}_{\veck} \times \partial_{k_y} \hat{\vec{n}}_{\veck} ) \cdot \hat{\vec{n}}_{\veck} \, . \tlabel{chern}
\end{align}
Similar to a winding number of a closed path $\gamma\colon S^1 \goesto \mathds{R}^2 \setminus \{ \vec{0} \}$ in the punctured plane, the Chern number cannot change unless the vector $\vec{n}_\veck$ is zero for a certain point $\veck$ in the Brillouin zone.
This shows that the space of all possible Hamiltonians $H_\veck$ factors into discrete classes of adiabatically equivalent models, characterized by their Chern number: band structures that can be deformed into one another without closing the bandgap.

It is this kind of robustness that makes topological properties interesting for applications.
The physical properties that follow from a nontrivial Chern number are robust against small perturbations in the above-mentioned sense.
The most important link to physical properties is the bulk-edge correspondence~\cite{Hatsugai1993}.
It guarantees the existence of edge states at the boundaries between different topological phases.
In particular, for a finite two-band system, the number of states at the edge of the system is equal to the Chern number (imagine the vacuum outside as being topologically trivial).
A related consequence of the nonzero Chern number appears in a fermionic system with a completely filled lowest band (Chern insulator).
Here, the Hall conductance is directly related to the Chern number via $\sigma_{xy} = \frac{e^2}{h} C$.


\section{Setup}

\doublefig{.43}{fig1/fig1a}{ }{.32}{fig1/fig1b}{ }{\sfA~Setup: Each lattice site of a two-dimensional optical lattice is occupied by a single polar molecule.
The molecules can be excited into two different rotational states.
Dipole-dipole interactions induce long-range tunneling links for the excitations.
\sfB~Rotational level structure of each molecule with applied electric field and additional microwave field with Rabi frequency $\Omega$ and detuning $\Delta$.}

We consider a two-dimensional system of ultracold polar molecules in a deep optical lattice with one molecule pinned at each lattice site, as shown in~\tref{fig1/fig1a}.
The remaining degree of freedom is given by the internal rotational excitations of the molecules with the Hamiltonian
\begin{align}
    H^{\text{rot}}_i &= B \vec{J}_i^2 - \vec{d}_i\cdot\vec{E}\,.
\end{align}
Here, $B$ is the rotational splitting, $\vec{J}_i$ is the angular momentum of the $i$th molecule and $\vec{d}_i$ is its dipole moment which is coupled to the applied static and microwave electric fields $\vec{E} = \vec{E}_{\text{s}} + \vec{E}_{\text{ac}}(t)$.
In the absence of external fields, the eigenstates $\ket{J,m}$ of $H^{\text{rot}}_{i}$ are conveniently labeled by the total angular momentum $J$ and its projection $m$.
Applying a static electric field mixes states with different $J$.
The projection $m$, however, can still be used to characterize the states.
In the following, we focus on the lowest state $\ketz$ with $m=0$ and the two degenerate excited states $\ketpm$ with $m = \pm 1$, see~\tref{fig1/fig1b}.
The first excited $m=0$ state, called $\keto$, will be used later.

The full system, including pairwise dipole-dipole interactions between the polar mole\-cules, is described by $H=\sum_i H^{\text{rot}}_i + \frac{1}{2}\sum_{i\ne j}H^{\text{dd}}_{ij}$.
As we have seen in \refandpage{ds:dop2d}, the interaction for the two-dimensional setup with the electric field perpendicular to the lattice can be expressed as
\begin{align}
    H^{\text{dd}}_{ij}=\frac{\kappa}{|\vec{R}_{ij}|^3} &\Big[d^0_i d^0_j + \frac{1}{2}\big(d^+_i d^-_j + d^-_i d^+_j) - \frac{3}{2}\big(d^-_i d^-_j \ef{2i\phi_{ij}} + d^+_i d^+_j \ef{-2i\phi_{ij}}\big)\Big] \tlabel{ddint}
\end{align}
with $\kappa=1/4\pi\epsilon_0$.
As before, $\phi_{ij}$ denotes the in-plane polar angle of the vector $\vec{R}_{ij} \equiv |\vec{R}_{ij}| \cdot (\cos \phi_{ij}, \sin \phi_{ij})^t$ which connects the two molecules at lattice sites $i$ and $j$, and the operators $d^0=d^z$ and $d^\pm=\mp (d^x\pm i d^y)/\sqrt{2}$ are the spherical components of the dipole operator.
The intrinsic spin-orbit coupling is visible in the last terms in \tref{ddint}, where a change in internal angular momentum by $\pm 2$ is associated with a change in orbital angular momentum encoded in the phase factor $e^{\mp 2i \phi_{ij}}$.

For molecules with a permanent dipole moment $d$ in an optical lattice with spacing $a$, the characteristic interaction energy $V=\kappa d^2/a^3$ is much weaker than the rotational splitting $B$.
For strong electric fields, the energy separation between the states $\ketpm_i$ and $\keto_i$ is also much larger than the interaction energy.
Then the number of $\ketpm$ excitations is conserved.
As described in \cref{ds:threelevel}, this allows us to map the Hamiltonian to a bosonic model: The lowest energy state $\prod_i \ketz_i$ with all molecules in the ground rotational state is the vacuum state, while excitations of a polar molecule into the state $\ket\pm_i$ are described by hard-core boson operators $\smash{\bopd_{i,\pm} =\ket{\pm}_i\!\bra{0}_i }$.
Note that these effective bosonic particles have a spin angular momentum of $m =\pm 1$.

\section{Bosonic model}

\sidefig{.3\textwidth}{spin-orbit/triangle}{Exemplary tunneling process along the smallest possible loop on the square lattice. The excitation hops from orbital $(\mathbf{1}, +)$ over $(\mathbf{2}, -)$ to $(\mathbf{3}, -)$ and back to $(\mathbf{1}, +)$. The spin-orbit coupling leads to a non-trivial flux $\phi_\text{flux} = \arg\!\bb{ \prod t_{ij} } = -\pi/2$, where $t_{ij}$ are the indicated tunneling rates. Reversing all orbitals $+ \leftrightarrow -$ changes the sign to $\phi_\text{flux} = \pi/2$.}

The dipole-dipole interaction gives rise to an effective hopping Hamiltonian for the bosonic particles due to the dipolar exchange terms:
$d^+_id^-_j$, for example, leads to a (long-range) tunneling $\bopd_{i,+}\bop_{j,+}$ for the ${+}$-bosons while the term $d^-_i d^-_j \ef{2i\phi_{i j}}$ generates spin-flip tunneling processes $\bopd_{i,-}\bop_{j,+} \ef{2i\phi_{ij}}$ with a phase that depends on the direction of tunneling.
For the study of the single particle band structure we can drop the term proportional to $d^0 d^0$ which describes a static dipolar interaction between the bosons.
Then, as shown in \refandpage{ds:pmmodel}, the interaction Hamiltonian reduces to
\begin{align}
    H^{\text{dd}} = \sum_{i\ne j}
    \frac{a^3}{R_{ij}^3}\;
    \psiopd_i\!
    \begingroup
        \renewcommand*{\arraystretch}{1.2}
        \begin{pmatrix}
            -t^+ & w \ef{-2i\phi_{ij}} \\
            w \ef{2i\phi_{ij}} & -t^-
        \end{pmatrix}
    \endgroup\!
    \psiop_j \,,
    \tlabel{hrealspace}
\end{align}
where we use the spinor notation $\psiopd_j = \big( \bopd_{j,+} , \bopd_{j,-} \big)$.
The energy scale of the hopping rates $t^+$, $t^-$, and $w$ is given by $V=\kappa d^2/a^3$. The exact expressions depend on the microscopic parameters and will be given in the next section.
The off-diagonal terms in \tref{hrealspace} lead to a spin-orbit coupling which can induce a non-trivial \qu{magnetic} flux along certain paths in the lattice, see \tref{spin-orbit/triangle}.

\subsection{Time-reversal symmetry breaking by the microwave field}
A crucial aspect for the generation of topological bands with a nonzero Chern number is the breaking of time-reversal symmetry.
In our setup, this is achieved by coupling the state $|+\rangle$ to the rotational state $\ket{m=2}$ with an off-resonant microwave field with Rabi frequency $\Omega \equiv 2 E_\text{ac} \absv{\braketop{m=2}{d^+}{{+}}}$ and detuning $\Delta$, see \tref{fig1/fig1b}.
For a large detuning $\Delta \gg \Omega, V$, the number of $\ketp$ (and $\ketm$) excitations is still conserved.
In the rotating frame, within the rotating wave approximation, the AC-dressed $\ketp$ state is given by
\begin{align}
\ketp_\text{ac} &= (1-\epsilon^2/2)\ketp - \epsilon \ket{m=2}
\end{align}
up to second order in $\epsilon=\Omega/2\Delta$.
Note that the coupling of the $\ketm$ state to the third $m=0$ state can be neglected due to a large detuning from the difference in Stark shifts between $m=0$ and $m=2$.
Therefore, the states $\ketz$ and $\ketm$ are essentially unaffected by the microwave.
To avoid cluttering of notation, we also drop the \emph{ac} label of the $\ketp$ state.

Then, the transition dipole moment for the $\ketp$ state is slightly reduced, compared to the $\ketm$ state. Using the definition in \cref{ds:dipolemomentspm}, we have $q_+ = |\smallbraketop{+}{d^+}{0}|= q_- (1-\epsilon^2/2)$. In turn, the nearest-neighbor tunneling rates from \cref{ds:nnrates} are given by
\begin{align}
    t^+ = \frac{\kappa q_{-}^2}{2a^3} (1 - \epsilon^2),\qquad
    t^- = \frac{\kappa q_{-}^2}{2a^3},\qquad
    w = \frac{3 \kappa q_{-}^2}{2a^3} (1-\epsilon^2/2).
\end{align}
Note that $t^{+} = t^{-}$ without the applied microwave (time-reversal symmetric point).
The microwave coupling also lifts the degeneracy between the two excitations $|\pm\rangle_{i}$ and provides an energy splitting given by the AC Stark shift, equal to $2\mu \equiv \Omega^2/4\Delta$.
We remark that this energy shift $2\mu$ can also be independently controlled via magnetic fields~\cite{Ospelkaus2010,Yan2013}.

\section{Topological band structure}
\tlabel{chernnumber}
In momentum space with $\psiop_{\veck}=\frac{1}{\sqrt{N_s}}\sum_{j} \psiop_{j}\ef{i\veck\vec{R}_j}$, including the internal energy $H_{i}^{\text{rot}}$ of the excitations $|\pm\rangle_{i}$, the Hamiltonian \labeltref{hrealspace} can be rewritten as
\begin{align}
    H &= \sum_{\veck} \psiopd_{\veck} \big({n^{0\vphantom\dagger}_{\veck} \: \mathds{1} + \vec{n}^{\vphantom \dagger}_{\veck}\cdot\vecsigma}\big) \psiop_{\veck}
    \tlabel{hkspace}
\end{align}
where it is useful to express the traceless part of the Hamiltonian
as the product of a three dimensional real vector $\vec{n}_{\veck}$ and the vector of Pauli matrices $\vecsigma$~\cite{Hasan2010,Bernevig2013}.
The real vector characterizes the spin-orbit coupling terms and takes the form
\begin{align}
    \vec{n}^{\vphantom 0}_{\veck} = \begin{pmatrix}
        w \Re \epsk^2 \\
        w \Im \epsk^2 \\
        \mu + t\, \epsk^0
    \end{pmatrix}.
\end{align}
Here, we have introduced the difference in tunneling rates $t = (t^--t^+)/2 > 0$.
The spin-independent hopping is determined by $n^0_{\veck} = -\bar{t}\, \epsk^0$ with the average tunneling rate ${\bar t} = (t^{+}+t^{-})/2$.
The behavior of both $n^0_\veck$ and $\vec{n}^{\vphantom 0}_\veck$ is determined by the previously used dipolar dispersion relation, extended to include a nonzero angular momentum transfer~$m$~\cite{Muller2010,Peter2012b,Syzranov2014,Peter2014}
\begin{align}
    \epskm = \sum_{j\ne 0} \frac{a^3}{|\vec{R}_j|^3}\ef{i\veck \vec{R}_j + i m \phi_{j}}.
\end{align}
The precise determination of this function can be achieved by an Ewald summation technique, providing a non-analytic low momentum behavior
$\epsk^0 \approx \epsZ^0 - 2\pi |\veck|a$ and
$\epsk^2 \approx -\frac{2\pi}{3} |\veck|a \ef{2i \varphi}$.
Here, $\epsZ^0 \approx 9.03$ and $\varphi$ is defined by $\hat{\veck}=(\cos \varphi, \sin \varphi)^t$.
For details, see \cref{dipolar_dispersion}.

\doublefigopt{.42}{fig2/fig2a}{fig2a}{ }{.42}{fig2/fig2b}{fig2b}{ }{
\sfA~Dispersion relation for the $\ketp$ and $\ketm$ states on the square lattice.
The dashed line shows the time-reversal invariant point $t=\mu=0$ with band touching at the $\Gamma$ and $\text{M}$ point.
The band minima are located at the two $\text{X}$ points $(\pi/a,0)$ and $(0, \pi/a)$.
The solid line shows the gapped topological bands in the time-reversal-broken system for $w/\bar{t}=3, \mu=0$ and $t/\bar{t}=0.4$.
For $t/\bar{t}\gtrsim 0.13$, the band minimum is at the $\Gamma$ point.
\sfB~Dispersion relation for the $\ketp$ and $\keto$ states for electric field angles $\Theta_0=0$ (dashed) and $\Theta_0=\pi/4$ (solid), respectively.
The latter has a lower band with flatness $f\approx 1$.
Note: The two '$\text{X}$' points $(\pi/a,0)$ and $(0, \pi/a)$ are not equivalent in this model as the electric field breaks the $x/y$ symmetry.
}

In the presence of time-reversal symmetry, represented by $\mathcal{T}=\sigma_x \mathcal{K}$ with $\mathcal{K}$ being complex conjugation, the system reduces to the one discussed in \refcite{Syzranov2014}.
At the $\mathcal{T}$-invariant point, i.e. $t=\mu=0$, the two energy bands of the system exhibit a band touching at the high-symmetry points $\vecGamma=(0,0)$ and $\vecM=(\pi/a, \pi/a)$ where $\epsk^2$ vanishes, see \tref{fig2a}.
The touching at the $\Gamma$ point is linear due to the low-momentum behavior of $\epsk^m$.
The lower band at the $\Gamma$ point is flat due to the exact cancellation of the linear terms.
Note that each of the touching points splits into two Dirac points if the square lattice is stretched into a rectangular lattice.

Breaking of time-reversal symmetry by the microwave field leads to an opening of a gap between the two bands.
The dispersion relation is given by
\begin{align}
    E_\pm(\veck)=- \bar{t}\, \epsk^0 \pm \sqrt{w^2 \big|\epsk^2\big|^2+\big(\mu+t\, \epsk^0\big)^2}
\end{align}
and shown in \tref{fig2a}.
It is gapped whenever the vector $\vec{n}_{\veck}\ne 0$.
The first two components can only vanish at the $\Gamma$ or $\text{M}$ point.
Consequently, the gap closes if and only if the third component is zero at one of these two points.
We find the two transition points
\begin{align}
    \mu/t &= -\epsZ^0 \approx -9.03, \\
    \mu/t &= -\epsM^0 = \big(1-1/\sqrt{2}\,\big)\epsZ^0 \approx +2.65.
\end{align}
In the gapped system, the Chern number~\cite{Hasan2010,Qi2011} can be calculated as the winding number of the normalized vector $\hat{\vec{n}}_\veck = \vec{n}_\veck/|\vec{n}_\veck|$ via
\begin{align}
    C &= \frac{1}{4\pi}\integralb{\text{BZ}}{}{^2\veck} ( \partial_{k_x} \hat{\vec{n}}_{\veck} \times \partial_{k_y} \hat{\vec{n}}_{\veck} ) \cdot \hat{\vec{n}}_{\veck} \, . \tlabel{chern}
\end{align}
We find that the Chern number of the lower band is $C=2$ for $-\epsZ^0 < \mu/t < -\epsM^0$, and zero outside this range.
The non-trivial topology solely results from dipolar spin-orbit coupling and time-reversal symmetry breaking.

Please note that it is necessary to truncate the summation in the expression for $\epskm$ in order to perform the calculation of the Chern number.
It is easy to check, however, that the remaining terms are not strong enough to close a gap.
Conversely, the cutoff radius needs to be larger than $\sqrt{2}a$, because the next-to-nearest neighbor terms are crucial for the nontrivial Chern number and may not be neglected (the $y$ component of $\vec{n}_\veck$ is zero otherwise).

\section{Flat bands}
One of the challenges is to find a specific setup that optimizes the flatness of the topological bands.
This can be achieved either by focusing on different lattice structures (see next section) or by an alternative choice for the two excitations.
Instead of considering $\ketp$ and $\ketm$, we choose a model including the $\ketp$ and $\keto$ states.
This is possible for weak electric fields, if the $\ketm$ state is shifted by a microwave field, or by exploiting the coupling between the nuclear spins of the polar molecules and the rotational degree of freedom~\cite{Ospelkaus2010,Yan2013}.
As described in \cref{ds:generalTilted} (excluding the $\ketm$ state), this leads to the single-particle Hamiltonian
\begin{align}
    H^{\text{dd}} = \sum_{i\ne j}
    \frac{a^3}{R_{ij}^3}\;
    \psiopd_i\!
    \begingroup
        \renewcommand*{\arraystretch}{1.2}
        \begin{pmatrix}
            -t^+ f_0 & w f_1^* \\
            w f_1    & -t^1 f_0
        \end{pmatrix}
    \endgroup\!
    \psiop_j \,,
\end{align}
where $f_m = f_m(\phi_{ij} - \Phi_0, \Theta_0)$ are the functions defined in \refandpage{ds:fmfunctions}, depending on the electric field direction $\Theta_0, \Phi_0$ and the tunneling rates
\begin{align}
    t^{+} = \frac{\kappa q_{+}^2}{2 a^3}, \quad
    t^{1} = -\frac{\kappa q_{1}^2}{a^3}, \quad
    w = \frac{3\kappa q_+ q_-}{\sqrt{2} a^3}.
\end{align}
This model intrinsically breaks time-reversal symmetry and has the advantage that the $\ketp$ and $\keto$ states have different signs for the tunneling strength, making the $\mathcal{T}$-breaking parameter $t=(t^+-t^1)/2$ large compared to $\bar{t}=(t^++t^1)/2$. % in fact, we know that t/tbar = 3t^+/(-t^+) = -3
For an electric field direction perpendicular to the lattice, this system is gapless because $f_1(\phi_{ij}, 0) = 0$.
Opening the gap is achieved by rotating the electric field away from the $z$-axis by an angle $\Theta$.
The dispersion relation for $\Theta=0$ and $\pi/4$ is shown in~\tref{fig2b}.
The lower band has a flatness ratio of $f = \text{bandgap}/\text{bandwidth} \approx 1$.


\section{Dependence on the lattice geometry}

\fig{.8}{fig3/fig3c}{Topological phase diagram in the honeycomb lattice for $t/\bar{t}=0.54$. The labels give the Chern numbers of the four bands (bar indicates negative number) from bottom to top while the solid lines correspond to touching points between two bands. The color indicates the flatness $f$ of the lowest band. The arrow shows the parameters of the flat-band model in~\tref{fig3/fig3b}.}

Returning to the simple setup in \tref{fig1/fig1b}, the influence of the lattice geometry on the topological properties can be exemplified by studying the case of the honeycomb lattice.
Due to the two distinct sublattices, we generally obtain four bands in the presence of broken time-reversal symmetry.
Depending on the microscopic parameters, the bands exhibit a rich topological structure, characterized by their Chern numbers.
Note that the Chern numbers are calculated with a numerical method similar to the one for the disordered system.
In \tref{fig3/fig3c}, we show a two-dimensional cut through the topological phase diagram, spanned by the parameters $t/\bar{t}, w/\bar{t}$ and $\mu/\bar{t}$.
We find a multitude of different topological phases with large areas of flatness $f > 0$ for the lowest band.
A flatness $f < 0$ indicates that the maximum of the lowest band is higher than the minimum of the second band.
In contrast to the square lattice, an energy splitting $\mu \ne 0$ is sufficient for a nonzero Chern number; $t\ne 0$ is not necessarily needed.
\Tref{fig3/fig3b} shows the dispersion relation with a lowest band of flatness $f\approx 6.4$ and a Chern number $C=-1$.
The different behavior of the same model on the square and hexagonal lattice will be explained in \tref{doublelayerhex}.

\section{Classification and double-layer picture}
\tlabel{doublelayer}

\doublefig{.36}{fig5/fig5a}{ }{.28}{fig5/fig5b}{ }{
Hopping strengths and flux pattern of a single layer in different lattices.
Tunneling elements without arrow are real numbers.
Complex hoppings have the indicated strength along the arrow and the complex conjugate in the opposite direction.
\sfA~Square lattice: A single layer can be constructed by stripes of one component along one of the primitive vectors, effectively doubling the unit cell.
The second layer is given by a translation along the second primitive vector.
\sfB~Honeycomb lattice: By distributing the $\ketp, \ketm$ orbitals to the two distinct sublattices it is possible to retain the symmetry of the lattice.
The second layer is given by a $60^\circ$ rotation.
}

Topological band structures can be classified by considering equivalence classes of models that can be continuously deformed into each other without closing the energy gap~\cite{Hasan2010}.
In particular, the Chern number of a single band can only change if it touches another band.
Using this idea, we show that the square-lattice model in its $C=2$ phase is adiabatically equivalent to a system of two uncoupled copies of a $C=1$ layer.

To see this, imagine separating the two orbitals $\ketp$ and $\ketm$ per site spatially along the $z$-direction (without changing any tunneling rates) such that we obtain two separate square lattice layers, called A and B.
Sorting all terms in the Hamiltonian into intra- and inter-layer processes, we can write
\begin{align}
H=H_\text{A} + H_\text{B} + \lambda H_\text{AB}
\end{align}
where $\lambda=1$.
The choice of which orbital resides in layer A (and B) can be made individually for each lattice site.
In any case, the resulting two layers will be interconnected by an infinite number of tunneling links $H_\text{AB}$.
The idea is to find a specific arrangement of the orbitals such that we can continuously let $\lambda \longrightarrow 0$ \emph{without} closing a gap in the excitation spectrum, preserving the topological phase while disentangling the layers.

Focusing on layer A (layer B being simply the complement), one possible arrangement is shown in \tref{fig5/fig5a}.
The ${+}$ (${-}$) orbitals are assigned to odd (even) columns along the $y$-direction.
For the Chern number of such a single layer we find $C=1$, using methods analogous to the ones described in \tref{chernnumber}.
The full system can be understood as two such layers, shifted by one lattice site in $x$-direction.
With a unit cell twice the size of the original model, each layer contributes to one half of the full Brillouin zone, effectively doubling the Chern number to $C=2$.

The single layer system has some interesting properties.
In \tref{fig5/fig5a} we show that it is possible to find a staggered magnetic flux pattern which creates the same tunneling phases as the dipole-dipole interaction, including tunneling up to the next-to-nearest neighbor level.
The resulting single layer model is reminiscent of the famous Haldane model~\cite{Haldane1988}, adapted to the square lattice~\cite{Goldman2013,Li2008,Liu2010,Liu2011,Stanescu2010,Wang2011,Wang2014,Yao2012,Yao2013}.
Using a site-dependent microwave dressing, it has been shown that a model similar to our single-layer system can be realized, giving rise to a $\nu=1/2$ fractional Chern insulating phase~\cite{Yao2012,Yao2013}.
It is rather remarkable that uniform dipole-dipole interactions give rise to a model usually requiring strong modulations on the order of the lattice spacing.

\subsection{Hexagonal lattice}
\tlabel{doublelayerhex}
The relation to the bilayer system also allows us to explain the different behavior on the hexagonal lattice.
Applying the same procedure, a single layer can be constructed which retains the original symmetry of the honeycomb lattice, see \tref{fig5/fig5b}.
Here, the two bands of the single layer also have a Chern number of $C=\pm 1$.
In contrast to the square lattice, however, the Brillouin zone of a single layer is the same as for the full (double layer) system with both orbitals at each site.
Consequently, the four bands of the full system are constructed from the combination of two $C=1$ and two $C=-1$ bands.
As a result, the lowest band in the honeycomb lattice can have a Chern number of $C=1$.
Note that the inter-layer coupling in the bilayer honeycomb system is crucial to open a gap.

\section{Influence of disorder}

\doublefig{.5}{fig3/fig3a}{ }{.27}{fig3/fig3b}{ }{\sfA~Sample-averaged Chern number $\langle C \rangle$ in the disordered system for increasing density $\rho$ of defects.
        A single realization either yields $C=2$ or $C=0$.
        Bars indicate two standard errors.
        The results are shown for square lattices of size $L \times L$ with $L=10, 20, 40$
        and a cutoff radius for the interaction $R_c \lesssim L/2$ slightly smaller than half the system size to avoid self-interaction.
        The long-range tunneling stabilizes the topological phase for defect densities $\rho \lesssim 0.45$.
        As a comparison, the dashed line shows the results for a $10 \times 10$ grid with tunneling only included up to the next-to-nearest neighbor, leading to a significant destabilization.
        \sfB~Two-dimensional projection of the dispersion relation in the honeycomb lattice for $t/\bar{t}=0.54, w/\bar{t}=1.97$ and $\mu/\bar{t}=-4.54$.
        The lowest band has a flatness ratio of $f\approx 6.4$ and a Chern number of $C=-1$.}

\sidefig{7cm}{fig4/fig4a}{Dispersion relation for the $\ketp$ and $\keto$ states on a cylindrical square lattice geometry with infinite extent in the $x$ direction and $31$ sites in the $y$ direction. Four edge states cross the bandgap in the $C=2$ phase (two for each edge), in accordance with the bulk-edge correspondence~\cite{Hatsugai1993}. The decay of the edge states at the two indicated points is shown in \tref{fig4/fig4a}.}

An experimental initialization with a perfectly uniform filling of one molecule per site is challenging.
Consequently, we analyze the stability of the topological band structure for random samples with a nonzero probability $\rho$ for an empty lattice site.
The determination of the Chern number for the disordered system follows ideas from refs.~\cite{Niu1985,Avron1985}.
We start with a finite geometry of $L \times L$ lattice sites and twisted boundary conditions
\begin{align}
    \psi(x + L, y) &= \ef{i\theta_x}\psi(x, y), \\
    \psi(x, y + L) &= \ef{i\theta_y}\psi(x, y)
\end{align}
for the single particle wave function.
Next, we randomly remove $\rho L^2$ lattice sites (dipoles).
We are interested in the Chern number of the lower `band', composed of the lowest $N_l=L^2 (1-\rho)$ states (there are $2N_l$ states in total).
To this end, we pretend to have a free fermionic system at half filling whose many-body ground state $\Psi=\Psi(\theta_x, \theta_y)$ is given by the Slater determinant of the lowest $N_l$ states.
Then, the Chern number can be calculated as
\begin{align}
    C &= \frac{1}{2\pi}\iint\!\mathrm{d}\theta_x \mathrm{d}\theta_y \, F(\theta_x, \theta_y), \tlabel{manybodychern}
\end{align}
where $F(\theta_x, \theta_y)$ is the many-body Berry curvature depending on the boundary condition twists:
\begin{align}
    F(\theta_x,\theta_y)=\Im\!\bb{ {\Big\langle\frac{\partial \Psi}{\partial \theta_y}\Big|\frac{\partial \Psi}{\partial \theta_x}\Big\rangle - \Big\langle\frac{\partial \Psi}{\partial \theta_x}\Big|\frac{\partial \Psi}{\partial \theta_y}\Big\rangle} }.
\end{align}
Note that \tref{manybodychern} reduces to \tref{chern} in the translationally invariant case.
For the numerical computations, we use a discretized version~\cite{Fukui2005}.
The results for the disordered system are summarized in~\tref{fig3/fig3a}.
We find that the long-range tunneling stabilizes the topological phase for defect densities $\rho\lesssim 0.45$.
The long-range tunneling ${\sim}|\vec{R}|^{-3}$ is found to significantly enhance the stability compared to a model with artificial truncation at the next-to-nearest neighbor level.

\section{Edge states}

\sidefig{6cm}{fig4/fig4b}{Exponentially decaying amplitude of the two edge states corresponding to the points shown in the spectrum in~\tref{fig4/fig4a}. Due to the opposite group velocity on opposing sites of the cylinder, the two edge states have the same chirality.}

One way to detect the topological band structure experimentally is to create a local excitation close to the edge of the system.
In the topologically nontrivial phase, the excitation will move along the edge in a specific direction due to the chiral nature of the edge state, a behavior that can be used as an indication of the topological nature of the bands~\cite{Hafezi2013}.
A convenient way to investigate the structure of the edge states is a cylindrical geometry which is infinite in one direction ($x$) and has a finite number of lattice sites in the other ($y$).
Then, the momentum $k_x$ in the infinite direction can still be used to characterize the states.
In \tref{fig4/fig4a} we show the spectrum for such a geometry in the $C=2$ phase on the square lattice for the $\ketp, \keto$ model.
The remnants of the two-dimensional bulk bands are still visible as a projection consisting of a bundle of single one-dimensional bands.
Four edge states cross the bandgap in accordance with the bulk-edge correspondence, as there are two states for each edge of the system.
These would also be visible in a spectroscopic analysis, as a single mode between the broad continuum of the two bands.
A characteristic property of edge states is the exponential decay from the boundary into the bulk of the system, see \tref{fig4/fig4b}.

\Cref{tb:edge/edge-square-disordered,tb:edge/edge-honeycomb-disordered} depict the two-dimensional structure of the edge-states in a small finite system for the square and honeycomb lattices. \Cref{tb:edge/edge-square-disordered,tb:edge/edge-honeycomb-disordered} show the same system with a fraction of $\rho=0.2$ of the lattice sites removed, demonstrating the robustness of the edge states against missing molecules.
For more details on the edge states in our system, see~\cite{Weber2015}.

\begin{figure}[t]
    \centering
    \subfloat[]{
        \ig{.38}{edge/edge-square}
        \tlabel{edge/edge-square}
    }
    \hspace{1.5cm}
    \subfloat[]{
        \ig{.45}{edge/edge-honeycomb}
        \tlabel{edge/edge-honeycomb}
    } \\
    \subfloat[]{
        \ig{.38}{edge/edge-square-disordered}
        \tlabel{edge/edge-square-disordered}
    }
    \hspace{1.5cm}
    \subfloat[]{
        \ig{.45}{edge/edge-honeycomb-disordered}
        \tlabel{edge/edge-honeycomb-disordered}
    }
    \caption{Edge state amplitudes $|\psi_+(x,y)|^2$ (red) and $|\psi_-(x,y)|^2$ (blue) on finite rectangular patches. \sfA~On the square lattice for the $\ketp, \ketm$ model in the $C=2$ phase with opposite orbitals on horizontal and vertical edges. The second edge state (not shown) has inverted orbitals. \sfB~Edge state on the honeycomb lattice between the lower two $C=-1$ and $C=0$ bands, for the same parameters as in \tref{fig3/fig3b}. \sfC~Edge-state in the disordered system with a defect density of $\rho= 0.2$ on the square lattice for a certain disorder realization. \sfD~Edge state on the honeycomb lattice which travels along an interior edge which developed due to the missing lattice sites (defect density $\rho=0.2$).}
\end{figure}

\section{Many-body system}
Finally, the most spectacular evidence of the topological nature would be the appearance of fractional Chern insulators in the interacting many-body system at a fixed density of excitations.
In our system, the hard-core constraint naturally provides a strong on-site interaction for the bosons.
In addition, the remaining static dipolar interactions are a tunable knob to control the interaction strength.
The most promising candidate for a hard-core bosonic fractional Chern insulator in a band with $C=2$ appears for a filling of $\nu = 2/3$, as suggested by numerical calculations~\cite{Moller2009,Wang2012a}, in agreement with the general classification scheme for interacting bosonic topological phases~\cite{Lu2012a,Chen2013}.
A continuum trial wavefunction for such a state would be the Halperin $(l;m;n)$ state~\cite{Halperin1984,Wu2013,Yao2013,Wang2012a,Wang2011} with
\begin{align}
    \Psi_{(l;m;n)} &= \mathcal{N}
    \prod_{i\ne j} \big(z_i^\downarrow - z_j^\downarrow\big)^l
    \prod_{i\ne j} \big(z_i^\uparrow -   z_j^\uparrow  \big)^m
    \prod_{i, j} \big(z_i^\uparrow -   z_j^\downarrow\big)^n
    \ef{-\frac{1}{4}\sum_{j,\alpha} \absvsq{z^\alpha_j} }.
\end{align}
This state is a natural extension of the Laughlin wave function to a double-layer system where $z_i^\downarrow=x_i^\downarrow+i y_i^\downarrow$ and $z_i^\uparrow$ are the complex coordinates in the lower and upper layer and $\mathcal{N}$ is a normalization constant.
Here, the two layers are given by the deconstruction described in \tref{doublelayer}.
For our hard-core bosonic system, one would expect a $(2;2;1)$ state where $l=2, m=2$ is the lowest non-trivial state which is compatible with the bosonic statistics and $n=1$ enforces the inter-layer hard-core constraint.
